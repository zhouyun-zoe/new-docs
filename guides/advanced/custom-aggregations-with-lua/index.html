<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">
<link rel="alternate" type="application/rss+xml" href="/new-docs/blog/rss.xml" title="Muta Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/new-docs/blog/atom.xml" title="Muta Blog Atom Feed">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu|Roboto|Source+Code+Pro">
<link rel="stylesheet" href="https://at-ui.github.io/feather-font/css/iconfont.css">

<title data-react-helmet="true">Custom Aggregations with Lua | Muta</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Custom Aggregations with Lua | Muta"><meta data-react-helmet="true" name="description" content="Custom Aggregations with Lua, in minutes, for free"><meta data-react-helmet="true" property="og:description" content="Custom Aggregations with Lua, in minutes, for free"><meta data-react-helmet="true" property="og:url" content="https://zhouyun-zoe.github.io/new-docs/guides/advanced/custom-aggregations-with-lua/"><meta data-react-helmet="true" name="twitter:card" content="summary">

<link data-react-helmet="true" rel="shortcut icon" href="/new-docs/img/muta-logo.png"><link data-react-helmet="true" rel="canonical" href="https://zhouyun-zoe.github.io/new-docs/guides/advanced/custom-aggregations-with-lua/">


<link rel="stylesheet" href="/new-docs/styles.e03ea446.css">


<link rel="preload" href="/new-docs/styles.c72b971d.js" as="script">

<link rel="preload" href="/new-docs/runtime~main.732ae49b.js" as="script">

<link rel="preload" href="/new-docs/main.5792c2cf.js" as="script">

<link rel="preload" href="/new-docs/1.7735386d.js" as="script">

<link rel="preload" href="/new-docs/2.180e53f2.js" as="script">

<link rel="preload" href="/new-docs/3.e035c0cb.js" as="script">

<link rel="preload" href="/new-docs/1c13b173.60d5f163.js" as="script">

<link rel="preload" href="/new-docs/c2b9b63c.4d744f5b.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_2ZIa"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/new-docs/"><strong>Muta</strong></a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/docs/">Docs</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/guides/">Guides</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__item__icon_only" title="Community" activeclassname="navbar__link--active" href="/new-docs/community/"><i class="feather icon-users"></i> </a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta"><i class="feather icon-github"></i> GitHub<span class="badge badge--secondary">90</span></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_34Mc moon_313u"></span></div><div class="react-toggle-track-x"><span class="toggle_34Mc sun_1Og-"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/new-docs/"><strong>Muta</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/docs/">Docs</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/guides/">Guides</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/blog/">Blog</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/community/">Community</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta">GitHub<span class="badge badge--secondary">90</span></a></li></ul></div></div></div></nav><div class="main-wrapper"><header class="hero domain-bg domain-bg--transforms"><div class="container"><div class="hero--category"><a href="/new-docs/guides/advanced/">advanced</a></div><h1 class="header_1mJE">Custom Aggregations with Lua</h1><div class="hero--subtitle">Write a custom transform for aggregating log events into metrics using Lua scripting</div><span class="tags_3AF9"><a class="badge badge--rounded badge--primary" href="/new-docs/guides/tags/type-guide/">type: guide</a><a class="badge badge--rounded badge--blue" href="/new-docs/guides/tags/domain-transforms/">domain: transforms</a><a class="badge badge--rounded badge--primary" href="/new-docs/guides/tags/transform-lua/">transform: lua</a></span></div></header><main class="container container--l container_1ncB"><aside class="sidebar_1pU0"><section class="avatar_1sJg"><div class="avatar avatar--lg avatar--vertical"><img class="avatar__photo avatar__photo--lg" src="https://github.com/zhouyun-zoe.png"><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/zhouyun-zoe" target="_blank" rel="author">zhouyun-zoe</a></div><small class="avatar__subtitle">Zhouyun is the professional char of Muta. Love everything expect programming.</small></div></div></section><section class="table-of-contents tableOfContents_1eMQ"><div class="section"><div class="title">Stats</div><div class="text--secondary text--bold"><i class="feather icon-book"></i> 6 min read</div><div class="text--secondary text--bold"><i class="feather icon-clock"></i> Updated <time pubdate="pubdate" datetime="2020-07-13">Jul 13th, 2020</time></div></div><div class="section"><div class="title">Contents</div><ul class="contents"><li><a href="#overview" class="contents__link">Overview</a></li><li><a href="#architectural-overview" class="contents__link">Architectural Overview</a><ul><li><a href="#hooks" class="contents__link">Hooks</a></li><li><a href="#timer-handlers" class="contents__link">Timer handlers</a></li></ul></li><li><a href="#first-implementation" class="contents__link">First Implementation</a></li><li><a href="#reduce-duplication" class="contents__link">Reduce Duplication</a></li><li><a href="#keep-all-code-together" class="contents__link">Keep All Code Together</a></li><li><a href="#a-loadable-module" class="contents__link">A Loadable Module</a></li><li><a href="#conclusion" class="contents__link">Conclusion</a></li></ul></div></section></aside><div class="article_mCV7"><article><div class="markdown"><a aria-hidden="true" tabindex="-1" class="anchor" id="overview"></a><p>While Vector&#x27;s built-in <a href="/docs/reference/transforms/">transforms</a> are fast, sometimes they are not expressive
enough for your needs. In such cases the <a href="/docs/reference/transforms/lua/"><code>lua</code></a> transform comes to rescue, letting you
define custom transformation logic.</p><p>This guide walks through various ways of defining an aggregating transform component that takes incoming log events,
counts them, and emits <a href="/docs/about/data-model/metric/#counter"><code>counter</code></a> metrics each 5 seconds.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="architectural-overview"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#architectural-overview" title="Direct link to heading">#</a>Architectural Overview</h2><p>Lua is an interpreted language embedded into Vector. When a <code>lua</code> transform is created, it starts an instance
of the Lua interpreter. As a consequence, different transforms are isolated and cannot interrupt each other.</p><p>The execution model is asynchronous, with two key concepts: <em>hooks</em> and <em>timer handlers</em>. Both of them are
user-defined Lua functions which are called by Vector at certain events.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="hooks"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#hooks" title="Direct link to heading">#</a>Hooks</h3><p>There are three types of hooks: <code>init</code>, <code>process</code>, and <code>shutdown</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="the-process-hook"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-process-hook" title="Direct link to heading">#</a>The <code>process</code> hook</h4><p>The most important of them is <code>process</code>, which is called on each incoming events. It can be defined like this:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-toml codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key property" style="color:#36acaa">hooks.process</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">function (event, emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  -- do something</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></pre></div></div><p>It takes a single event and can output one or many of them using the <code>emit</code> function provided as the second argument.</p><p>For example, the body of the function above could have been</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-lua codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">evnet</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">my_field </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my value&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">emit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span></div></div></pre></div></div><p>The code above sets field <code>my_field</code> to value <code>&quot;my_value&quot;</code> and sends the newly created event to the downstream
components. Read more about event representation <a href="/docs/reference/transforms/lua/#representation-of-events">in the reference</a>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="the-init-hook"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-init-hook" title="Direct link to heading">#</a>The <code>init</code> hook</h4><p>The <code>init</code> hook is similar to <code>process</code> hook, but it is called before the first call of the <code>process</code> hook, and thus
takes no events as its arguments.</p><p>Note that it although it is called before the first event, it is called only after the first event is ready to be
processed. However, one should not rely on this behavior, as it is not guaranteed to not change in the future.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor" id="the-shutdown-hook"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-shutdown-hook" title="Direct link to heading">#</a>The <code>shutdown</code> hook</h4><p>The <code>shutdown</code> hook is called after the last event is received. It doesn&#x27;t take events as arguments as well.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor" id="timer-handlers"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#timer-handlers" title="Direct link to heading">#</a>Timer handlers</h3><p>Timer handlers are similar to hooks by being Lua functions capable of producing events. However, they are called
periodically at pre-defined intervals.</p><p>All of the functions listed above share a single runtime, so they can communicate between each other using global
variables.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="first-implementation"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#first-implementation" title="Direct link to heading">#</a>First Implementation</h2><p>Using the knowledge from the previous section, it is possible to write down the following transform definition:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.aggregator</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lua&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># add names of the input components here</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.init</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function (emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    count = 0 -- initialize state by setting a global variable</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.process</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function (event, emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    count = count + 1 -- increment the counter and exit</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">timers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token key property" style="color:#36acaa">interval_seconds</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">handler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function (emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    emit {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      metric = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        name = &quot;event_counter&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        kind = &quot;incremental&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        timestamp = os.date(&quot;!*t&quot;),</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        counter = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">          value = counter</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    counter = 0</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.shutdown</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function (emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    emit {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      metric = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        name = &quot;event_counter&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        kind = &quot;incremental&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        timestamp = os.date(&quot;!*t&quot;),</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        counter = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">          value = counter</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></pre></div></div><p>One could plug it into a <a href="/docs/about/concepts/#pipelines">pipeline</a> and it would work!</p><p>However, this code could and should be refactored. Hold on to the next section to see how it could be done.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="reduce-duplication"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#reduce-duplication" title="Direct link to heading">#</a>Reduce Duplication</h2><p>A bird&#x27;s-eye view of the transform definition reveals that the timer handler and the shutdown hook are almost
identical. It is possible make the config more <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a> by extracting creation of the counter into
a dedicated function. Such a function can be placed into the <a href="/docs/reference/transforms/lua/#source">source</a>
section of the config:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-toml codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key property" style="color:#36acaa">source</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function make_counter(value)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    return metric = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      name = &quot;event_counter&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      kind = &quot;incremental&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      timestamp = os.date(&quot;!*t&quot;),</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      counter = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        value = value</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></pre></div></div><p>and then adjusting the timer handler</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-toml codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key property" style="color:#36acaa">timers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token key property" style="color:#36acaa">interval_seconds</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">handler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function (emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    emit(make_counter(counter))</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    counter = 0</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span></div></div></pre></div></div><p>and the <code>shutdown</code> hook:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-toml codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token key property" style="color:#36acaa">hooks.shutdown</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function (emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    emit(make_counter(counter))</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></pre></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="keep-all-code-together"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#keep-all-code-together" title="Direct link to heading">#</a>Keep All Code Together</h2><p>The new config looks tidier, but in order to make it more readable, it is also possible to gather implementations of
all functions into the <code>source</code> section, resulting in the following component declaration:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.aggregator</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lua&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># add names of the input components here</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.init</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;init&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.process</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;process&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.shutdown</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shutdown&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">timers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token key property" style="color:#36acaa">interval_seconds</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">handler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;timer_handler&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">source</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function init()</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    count = 0</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="display:inline-block;color:#e3116c">
</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function process()</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    count = count + 1</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="display:inline-block;color:#e3116c">
</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function timer_handler(emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    emit(make_counter(counter))</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    counter = 0</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="display:inline-block;color:#e3116c">
</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function shutdown(emit)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    emit(make_counter(counter))</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="display:inline-block;color:#e3116c">
</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  function make_counter(value)</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    return metric = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      name = &quot;event_counter&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      kind = &quot;incremental&quot;,</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      timestamp = os.date(&quot;!*t&quot;),</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      counter = {</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        value = value</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    }</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  end</span></div><div class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;&quot;&quot;</span></div></div></pre></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="a-loadable-module"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#a-loadable-module" title="Direct link to heading">#</a>A Loadable Module</h2><p>As the Lua source grows, it becomes benefitial to place it into a separate file. One obvious advantage is the
possiblity to use Lua syntax highlighting in the text editor. A less obvious one is the possibility to share
common functionality between different scripted transforms using <a href="https://www.lua.org/manual/5.3/manual.html#6.3">loadable modules</a>.</p><p>There are many ways to use modules in Lua. The simplest one is to just use <a href="https://www.lua.org/manual/5.3/manual.html#pdf-require"><code>require</code></a> function to
evaluate code from a file, setting up some global variables.</p><p>With this approach the config from the previous section becomes split into two files:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">aggregator.lua</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-lua codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> aggregator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  count </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> count </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> aggregator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">timer_handler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">emit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">emit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">make_counter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> aggregator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">shutdown</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">emit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">emit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">make_counter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> aggregator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">make_counter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> metric </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event_counter&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    kind </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;incremental&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    timestamp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;!*t&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span></div></div></pre></div></div><p>and</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.aggregator</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lua&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">version</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># add names of the input components here</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.init</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;init&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.process</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;process&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">hooks.shutdown</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shutdown&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">timers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token key property" style="color:#36acaa">interval_seconds</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token key property" style="color:#36acaa">handler</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;timer_handler&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key property" style="color:#36acaa">source</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;require(&#x27;aggregator&#x27;)&quot;</span></div></div></pre></div></div><p>There are also <a href="http://lua-users.org/wiki/ModulesTutorial">other possibilities</a> to define Lua modules which do not require to use
global variables, but they are not Vector-specific, and so out of scope of this guide.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="conclusion"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#conclusion" title="Direct link to heading">#</a>Conclusion</h2><p>As you have witnessed by reading this guide, the power of Vector comes from its flexibility. In addition to
providing a <a href="/docs/reference/transforms/">rich set</a> of predefined transforms for building production-grade observability
pipelines, it makes it possible to write custom aggregations as Lua scripts. This allows each role of Vector
in a <a href="/docs/setup/deployment/topologies/">deployment topology</a> to perform various kinds of aggregations, providing
alternatives to centralized logs aggregation.</p></div></article><nav class="pagination-nav paginator_1WWz"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/new-docs/guides/advanced/managing-complex-configs"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Building &amp; Managing Complex Configs</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/new-docs/guides/advanced/schemas"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Managing Schemas in Vector »</h4></a></div></nav></div></main></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col col--5 footer__col"><div class="margin-bottom--md"></div><div class="margin-bottom--md"><div class="mailing-list"><form action="https://app.getvero.com/forms/a748ded7ce0da69e6042fa1e21042506" method="post" class="mailing-list--form"><input type="email" class="input input--undefined" name="email" placeholder="you@email.com" style="width:150px"><button class="button button--primary button--undefined" type="submit">Subscribe</button></form></div></div><div><a href="https://twitter.com/vectordotdev" target="_blank"><i class="feather icon-twitter" alt="Vector&#x27;s Twitter"></i></a>    <a href="https://chat.vector.dev" target="_blank"><i class="feather icon-message-circle" alt="Vector&#x27;s Chat"></i></a>    <a href="https://github.com/timberio/vector" target="_blank"><i class="feather icon-github" alt="Vector&#x27;s Github Repo"></i></a>    <a href="https://vector.dev/blog/atom.xml" target="_blank"><i class="feather icon-rss" alt="Vector&#x27;s RSS feed"></i></a></div></div><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/about/what-is-muta/">What is Muta?</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/community/#team">The Team</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/contact/">Contact Us</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Development</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/reference/sources/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/reference/transforms/">Service Dev</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/reference/sinks/">Dapp Dev</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://talk.nervos.org/">Forum</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discord.com/invite/rN35fe8">Discord</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/nervosnetwork">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/new-docs/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta">GitHub</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://timber.io/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_3L_r"></a></div>Copyright © 2020 NervosNetwork<br><small><a href="https://github.com/timberio/vector/security/policy">Security Policy</a> • <a href="https://github.com/timberio/vector/blob/master/PRIVACY.md">Privacy Policy</a></small></div></div></footer>
</div>

<script src="/new-docs/styles.c72b971d.js"></script>

<script src="/new-docs/runtime~main.732ae49b.js"></script>

<script src="/new-docs/main.5792c2cf.js"></script>

<script src="/new-docs/1.7735386d.js"></script>

<script src="/new-docs/2.180e53f2.js"></script>

<script src="/new-docs/3.e035c0cb.js"></script>

<script src="/new-docs/1c13b173.60d5f163.js"></script>

<script src="/new-docs/c2b9b63c.4d744f5b.js"></script>


</body>
</html>
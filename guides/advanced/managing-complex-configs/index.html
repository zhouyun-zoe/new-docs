<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">
<link rel="alternate" type="application/rss+xml" href="/new-docs/blog/rss.xml" title="Muta Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/new-docs/blog/atom.xml" title="Muta Blog Atom Feed">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu|Roboto|Source+Code+Pro">
<link rel="stylesheet" href="https://at-ui.github.io/feather-font/css/iconfont.css">

<title data-react-helmet="true">Building &amp; Managing Complex Configs | Muta</title>

<meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"><meta data-react-helmet="true" property="og:title" content="Building &amp; Managing Complex Configs | Muta"><meta data-react-helmet="true" name="description" content="Building &amp; Managing Complex Configs, in minutes, for free"><meta data-react-helmet="true" property="og:description" content="Building &amp; Managing Complex Configs, in minutes, for free"><meta data-react-helmet="true" property="og:url" content="https://zhouyun-zoe.github.io/new-docs/guides/advanced/managing-complex-configs/"><meta data-react-helmet="true" name="twitter:card" content="summary">

<link data-react-helmet="true" rel="shortcut icon" href="/new-docs/img/muta-logo.png"><link data-react-helmet="true" rel="canonical" href="https://zhouyun-zoe.github.io/new-docs/guides/advanced/managing-complex-configs/">


<link rel="stylesheet" href="/new-docs/styles.e03ea446.css">


<link rel="preload" href="/new-docs/styles.c72b971d.js" as="script">

<link rel="preload" href="/new-docs/runtime~main.732ae49b.js" as="script">

<link rel="preload" href="/new-docs/main.5792c2cf.js" as="script">

<link rel="preload" href="/new-docs/1.7735386d.js" as="script">

<link rel="preload" href="/new-docs/2.180e53f2.js" as="script">

<link rel="preload" href="/new-docs/3.e035c0cb.js" as="script">

<link rel="preload" href="/new-docs/1c13b173.60d5f163.js" as="script">

<link rel="preload" href="/new-docs/96429933.3a7a808b.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_2ZIa"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/new-docs/"><strong>Muta</strong></a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/docs/">Docs</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/guides/">Guides</a><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__item__icon_only" title="Community" activeclassname="navbar__link--active" href="/new-docs/community/"><i class="feather icon-users"></i> </a><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta"><i class="feather icon-github"></i> GitHub<span class="badge badge--secondary">90</span></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_34Mc moon_313u"></span></div><div class="react-toggle-track-x"><span class="toggle_34Mc sun_1Og-"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/new-docs/"><strong>Muta</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/docs/">Docs</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/guides/">Guides</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/blog/">Blog</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" activeclassname="navbar__link--active" href="/new-docs/community/">Community</a></li><li class="menu__list-item"><a class="navbar__item navbar__link" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta">GitHub<span class="badge badge--secondary">90</span></a></li></ul></div></div></div></nav><div class="main-wrapper"><header class="hero domain-bg domain-bg--config"><div class="container"><div class="hero--category"><a href="/new-docs/guides/advanced/">advanced</a></div><h1 class="header_1mJE">Building &amp; Managing Complex Configs</h1><div class="hero--subtitle">Strategies for building and managing complex Vector configs</div><span class="tags_3AF9"><a class="badge badge--rounded badge--primary" href="/new-docs/guides/tags/type-guide/">type: guide</a><a class="badge badge--rounded badge--blue" href="/new-docs/guides/tags/domain-config/">domain: config</a></span></div></header><main class="container container--l container_1ncB"><aside class="sidebar_1pU0"><section class="avatar_1sJg"><div class="avatar avatar--lg avatar--vertical"><img class="avatar__photo avatar__photo--lg" src="https://github.com/zhouyun-zoe.png"><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/zhouyun-zoe" target="_blank" rel="author">zhouyun-zoe</a></div><small class="avatar__subtitle">Zhouyun is the professional char of Muta. Love everything expect programming.</small></div></div></section><section class="table-of-contents tableOfContents_1eMQ"><div class="section"><div class="title">Stats</div><div class="text--secondary text--bold"><i class="feather icon-book"></i> 5 min read</div><div class="text--secondary text--bold"><i class="feather icon-clock"></i> Updated <time pubdate="pubdate" datetime="2020-07-13">Jul 13th, 2020</time></div></div><div class="section"><div class="title">Contents</div><ul class="contents"><li><a href="#overview" class="contents__link">Overview</a></li><li><a href="#generating-configs" class="contents__link">Generating Configs</a></li><li><a href="#testing-configs" class="contents__link">Testing Configs</a></li><li><a href="#organizing-configs" class="contents__link">Organizing Configs</a></li><li><a href="#updating-configs" class="contents__link">Updating Configs</a></li></ul></div></section></aside><div class="article_mCV7"><article><div class="markdown"><a aria-hidden="true" tabindex="-1" class="anchor" id="overview"></a><div class="list--icons list--icons--arrow list--tight list--indent margin-bottom--lg alert alert--info alert--fill alert--rounded" role="alert"><p class="text--lg margin-bottom--sm" style="margin-top:-0.25em">Before you begin, this guide assumes the following:</p><ul><li>You understand the <a href="/docs/about/concepts/">basic Vector concepts</a> and understand <a href="/guides/getting-started/your-first-pipeline/">how to set up a pipeline</a>.</li></ul></div><p>Writing large configuration files is not yet an official olympic event. However,
it&#x27;s still a good idea to get yourself ahead of the competition. In this guide
we&#x27;re going to cover some tips and tricks that will help you write clear, bug
free Vector configs that are easy to maintain.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="generating-configs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#generating-configs" title="Direct link to heading">#</a>Generating Configs</h2><p>In Vector each component of a pipeline specifies which components it consumes
events from. This makes it very easy to build multiplexed topologies. However,
writing a chain of transforms this way can sometimes be frustrating as the
number of transforms increases.</p><p>Luckily, the Vector team are desperate for your approval and have worked hard to
mitigate this with the <code>generate</code> subcommand, which can be used to generate the
boilerplate for you. The command expects a list of components, where it then
creates a config with all of those components connected in a linear chain.</p><p>For example, if we wished to create a chain of three transforms; <code>json_parser</code>,
<code>add_fields</code>, and <code>remove_fields</code>, we can run:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-bash codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">vector generate /json_parser,add_fields,remove_fields </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> vector.toml</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Find out more with `vector generate --help`</span></div></div></pre></div></div><p>And most of the boilerplate will be written for us, with each component printed
with an <code>inputs</code> field that specifies the component before it:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.transform0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;somewhere&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;json_parser&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># etc ...</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.transform1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;transform0&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;add_fields&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># etc ...</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.transform2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;transform1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;remove_fields&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># etc ...</span></div></div></pre></div></div><p>The names of the generated components are sequential (<code>transform0</code>,
<code>transform1</code>, and so on). It&#x27;s therefore worth doing a search and replace with
your editor to give them better names, e.g. <code>s/transform2/scrub_emails/g</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="testing-configs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#testing-configs" title="Direct link to heading">#</a>Testing Configs</h2><p>Test driven Configurationn is a paradigm we just made up, so there&#x27;s still time
for you to adopt it <em>before</em> it&#x27;s cool. Vector supports complementing your
configs with <a href="/guides/advanced/unit-testing/">unit tests</a>, and as it turns out
they&#x27;re also pretty useful during the building stage.</p><p>Let&#x27;s imagine we are in the process of building the config from the <a href="/guides/advanced/unit-testing/">unit test
guide</a>, we might start off with our source and
the grok parser:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">sources.over_tcp</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;socket&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">mode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tcp&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">address</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.0.0.0:9000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">transforms.foo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;grok_parser&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">inputs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;over_tcp&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">pattern</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:level} %{GREEDYDATA:message}&quot;</span></div></div></pre></div></div><p>A common way to test this transform might be to temporarily change the source
into a <code>stdin</code> type, add a <code>console</code> sink pointed to our target transform, and
run it with some sample data. However, this is awkward as it means distorting
our config to run tests rather than focusing on features.</p><p>Instead, we can leave our source as a <code>socket</code> type and add a unit test to the
end of our config:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;check_simple_log&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests.inputs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">insert_at</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;raw&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">value</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2019-11-28T12:00:00+00:00 info Sorry, I&#x27;m busy this week Cecil&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests.outputs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">extract_from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span></div></div></pre></div></div><p>When we add a unit test output without any conditions it will simply print the
input and output events of a transform, allowing us to inspect its behavior:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-sh codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">$ vector test ./vector.toml</span></div><div class="token-line" style="color:#393A34"><span class="token plain">Running vector.toml tests</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test vector.toml: check_simple_log ... passed</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">inspections:</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">--- vector.toml ---</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">test &#x27;check_simple_log&#x27;:</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">check transform &#x27;foo&#x27; payloads (events encoded as JSON):</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  input: {&quot;timestamp&quot;:&quot;2020-02-11T15:04:02.361999Z&quot;, &quot;message&quot;:&quot;2019-11-28T12:00:00+00:00 info Sorry, I&#x27;m busy this week Cecil&quot;}</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  output: {&quot;level&quot;:&quot;info&quot;,&quot;message&quot;:&quot;Sorry, I&#x27;m busy this week Cecil&quot;, &quot;timestamp&quot;:&quot;2019-11-28T12:00:00+00:00&quot;}</span></div></div></pre></div></div><p>As we introduce new transforms to our config we can change the test output
to check the latest transform. Or, occasionally, we can add conditions to an
output in order to turn it into a regression test:</p><div class="mdxCodeBlock_iHAB"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_2TQJ">vector.toml</div><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb copyButtonWithTitle_qt-P">Copy</button><pre class="prism-code language-toml codeBlock_1wn8 codeBlockWithTitle_1f_H"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;check_simple_log&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests.inputs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">insert_at</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;raw&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">value</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2019-11-28T12:00:00+00:00 info Sorry, I&#x27;m busy this week Cecil&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># This is now a regression test</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests.outputs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">extract_from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;foo&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests.outputs.conditions</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key property" style="color:#36acaa">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;check_fields&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key property" style="color:#36acaa">&quot;message.equals&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Sorry, I&#x27;m busy this week Cecil&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># And we add a new output without conditions for inspecting</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># a new transform</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token table class-name">tests.outputs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key property" style="color:#36acaa">extract_from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bar&quot;</span></div></div></pre></div></div><p>How many tests you add is at your discretion, but you probably don&#x27;t need to
test every single transform. We recommend every four transforms, except during a
full moon when you should test every two just to be sure.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="organizing-configs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#organizing-configs" title="Direct link to heading">#</a>Organizing Configs</h2><p>Building configs is only the beginning. Once it&#x27;s built you need to make sure
pesky meddlers don&#x27;t ruin it. The best way to keep on top of that is to break
large configs down into smaller more manageable pieces.</p><p>With Vector you can split a config down into as many files as you like and run
them all as a larger topology:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_3RXF"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1PCb">Copy</button><pre class="prism-code language-bash codeBlock_1wn8"><div class="codeBlockLines_3HrO" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># These three examples run the same two configs together:</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ vector -c ./configs/foo.toml -c ./configs/bar.toml</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ vector -c ./configs/*.toml</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ vector -c ./configs/foo.toml ./configs/bar.toml</span></div></div></pre></div></div><p>If you have a large chain of components it&#x27;s a good idea to break them out into
individual files, each with its own unit tests.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="updating-configs"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-configs" title="Direct link to heading">#</a>Updating Configs</h2><p>Sometimes it&#x27;s useful to update Vector configs on the fly. If you find yourself
tinkering with a config that Vector is already running you can prompt it to
reload the changes you&#x27;ve made by sending it a <code>SIGHUP</code> signal.</p><p>If you&#x27;re running Vector in environments where it&#x27;s not possible to issue
<code>SIGHUP</code> signals you can instead run it with the <code>--watch-config</code> flag and it&#x27;ll
automatically gobble up changes whenever the file is written to.</p></div></article><nav class="pagination-nav paginator_1WWz"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/new-docs/guides/getting-started/next-steps"><h5 class="pagination-nav__link--sublabel">Previous</h5><h4 class="pagination-nav__link--label">« Next Steps</h4></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/new-docs/guides/advanced/custom-aggregations-with-lua"><h5 class="pagination-nav__link--sublabel">Next</h5><h4 class="pagination-nav__link--label">Custom Aggregations with Lua »</h4></a></div></nav></div></main></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col col--5 footer__col"><div class="margin-bottom--md"></div><div class="margin-bottom--md"><div class="mailing-list"><form action="https://app.getvero.com/forms/a748ded7ce0da69e6042fa1e21042506" method="post" class="mailing-list--form"><input type="email" class="input input--undefined" name="email" placeholder="you@email.com" style="width:150px"><button class="button button--primary button--undefined" type="submit">Subscribe</button></form></div></div><div><a href="https://twitter.com/vectordotdev" target="_blank"><i class="feather icon-twitter" alt="Vector&#x27;s Twitter"></i></a>    <a href="https://chat.vector.dev" target="_blank"><i class="feather icon-message-circle" alt="Vector&#x27;s Chat"></i></a>    <a href="https://github.com/timberio/vector" target="_blank"><i class="feather icon-github" alt="Vector&#x27;s Github Repo"></i></a>    <a href="https://vector.dev/blog/atom.xml" target="_blank"><i class="feather icon-rss" alt="Vector&#x27;s RSS feed"></i></a></div></div><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/about/what-is-muta/">What is Muta?</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/community/#team">The Team</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/contact/">Contact Us</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Development</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/reference/sources/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/reference/transforms/">Service Dev</a></li><li class="footer__item"><a class="footer__link-item" href="/new-docs/docs/reference/sinks/">Dapp Dev</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://talk.nervos.org/">Forum</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://discord.com/invite/rN35fe8">Discord</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/nervosnetwork">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/new-docs/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/nervosnetwork/muta">GitHub</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://timber.io/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_3L_r"></a></div>Copyright © 2020 NervosNetwork<br><small><a href="https://github.com/timberio/vector/security/policy">Security Policy</a> • <a href="https://github.com/timberio/vector/blob/master/PRIVACY.md">Privacy Policy</a></small></div></div></footer>
</div>

<script src="/new-docs/styles.c72b971d.js"></script>

<script src="/new-docs/runtime~main.732ae49b.js"></script>

<script src="/new-docs/main.5792c2cf.js"></script>

<script src="/new-docs/1.7735386d.js"></script>

<script src="/new-docs/2.180e53f2.js"></script>

<script src="/new-docs/3.e035c0cb.js"></script>

<script src="/new-docs/1c13b173.60d5f163.js"></script>

<script src="/new-docs/96429933.3a7a808b.js"></script>


</body>
</html>